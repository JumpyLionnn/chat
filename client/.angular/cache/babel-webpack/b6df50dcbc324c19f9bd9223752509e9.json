{"ast":null,"code":"import _asyncToGenerator from \"D:\\\\projects\\\\chat\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component, ViewChild } from '@angular/core';\nimport { Message } from './chatmessage/message.model';\nlet ChatboxComponent = class ChatboxComponent {\n  constructor() {\n    this.allowSendingMessages = false;\n    this.messageContentInput = \"\";\n    this.nameInputContent = \"\";\n    this.messages = [];\n    this.alerts = [];\n  }\n\n  ngOnInit() {}\n\n  ngAfterViewChecked() {\n    this.adjustScroll();\n    console.log(this.showScrollDownButton());\n  }\n\n  onSendMessage() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      // making sure the message data is valid\n      const content = _this.messageContentInput.trim();\n\n      const username = _this.nameInputContent.trim();\n\n      if (content === \"\") {\n        _this.addAlert(\"error\", \"You can not send an empty message.\");\n\n        return;\n      }\n\n      if (username === \"\") {\n        _this.addAlert(\"error\", \"You dont have a name.\");\n\n        return;\n      } //calculating the date string\n\n\n      const today = new Date();\n      const hours = today.getHours();\n      const minutes = today.getMinutes();\n      const time = (hours > 12 ? hours - 12 : hours) + \":\" + (minutes < 10 ? \"0\" + minutes : minutes) + (hours > 11 ? \" PM\" : \" AM\"); //adding the message to the list\n\n      _this.messages.push(new Message(username, content, time)); //reseting the input\n\n\n      _this.messageContentInput = \"\";\n      _this.allowSendingMessages = false;\n    })();\n  }\n\n  onMessageContentInputChange(event) {\n    this.messageContentInput = event.target.value;\n\n    if (this.messageContentInput.trim() === \"\") {\n      this.allowSendingMessages = false;\n    } else {\n      this.allowSendingMessages = true;\n    }\n  }\n\n  onInputKeyDown(event) {\n    if (event.key === \"Enter\" && !event.repeat) {\n      this.onSendMessage();\n    }\n  }\n\n  adjustScroll() {\n    const messagesContainer = this.messagesContainerRef.nativeElement;\n\n    if (messagesContainer.scrollTop + messagesContainer.clientHeight >= messagesContainer.scrollHeight - 250) {\n      messagesContainer.scrollTop = messagesContainer.scrollHeight;\n    }\n  }\n\n  scrollDown() {\n    this.messagesContainerRef.nativeElement.scrollTo({\n      top: this.messagesContainerRef.nativeElement.scrollHeight,\n      behavior: \"smooth\"\n    });\n  }\n\n  showScrollDownButton() {\n    const messagesContainer = this.messagesContainerRef.nativeElement;\n    return messagesContainer.scrollTop + messagesContainer.clientHeight < messagesContainer.scrollHeight - 250;\n  }\n\n  onReplyClick(event) {\n    this.messageContentInput = `@${event.username} `;\n  }\n\n  addAlert(type, content, time = 5000) {\n    const alert = this.alerts[this.alerts.push({\n      type: type,\n      content: content\n    })];\n    setTimeout(() => {\n      this.alerts.splice(this.alerts.indexOf(alert), 1);\n    }, time);\n  }\n\n  onAlertClose(index) {\n    this.alerts.splice(index, 1);\n  }\n\n};\n\n__decorate([ViewChild(\"messagesContainer\", {\n  static: true\n})], ChatboxComponent.prototype, \"messagesContainerRef\", void 0);\n\nChatboxComponent = __decorate([Component({\n  selector: 'app-chatbox',\n  templateUrl: './chatbox.component.html',\n  styleUrls: ['./chatbox.component.css']\n})], ChatboxComponent);\nexport { ChatboxComponent };","map":{"version":3,"sources":["D:/projects/chat/src/app/chatbox/chatbox.component.ts"],"names":["__decorate","Component","ViewChild","Message","ChatboxComponent","constructor","allowSendingMessages","messageContentInput","nameInputContent","messages","alerts","ngOnInit","ngAfterViewChecked","adjustScroll","console","log","showScrollDownButton","onSendMessage","content","trim","username","addAlert","today","Date","hours","getHours","minutes","getMinutes","time","push","onMessageContentInputChange","event","target","value","onInputKeyDown","key","repeat","messagesContainer","messagesContainerRef","nativeElement","scrollTop","clientHeight","scrollHeight","scrollDown","scrollTo","top","behavior","onReplyClick","type","alert","setTimeout","splice","indexOf","onAlertClose","index","static","prototype","selector","templateUrl","styleUrls"],"mappings":"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","sourcesContent":["import { __decorate } from \"tslib\";\r\nimport { Component, ViewChild } from '@angular/core';\r\nimport { Message } from './chatmessage/message.model';\r\nlet ChatboxComponent = class ChatboxComponent {\r\n    constructor() {\r\n        this.allowSendingMessages = false;\r\n        this.messageContentInput = \"\";\r\n        this.nameInputContent = \"\";\r\n        this.messages = [];\r\n        this.alerts = [];\r\n    }\r\n    ngOnInit() {\r\n    }\r\n    ngAfterViewChecked() {\r\n        this.adjustScroll();\r\n        console.log(this.showScrollDownButton());\r\n    }\r\n    async onSendMessage() {\r\n        // making sure the message data is valid\r\n        const content = this.messageContentInput.trim();\r\n        const username = this.nameInputContent.trim();\r\n        if (content === \"\") {\r\n            this.addAlert(\"error\", \"You can not send an empty message.\");\r\n            return;\r\n        }\r\n        if (username === \"\") {\r\n            this.addAlert(\"error\", \"You dont have a name.\");\r\n            return;\r\n        }\r\n        //calculating the date string\r\n        const today = new Date();\r\n        const hours = today.getHours();\r\n        const minutes = today.getMinutes();\r\n        const time = (hours > 12 ? hours - 12 : hours) + \":\" + (minutes < 10 ? \"0\" + minutes : minutes) + (hours > 11 ? \" PM\" : \" AM\");\r\n        //adding the message to the list\r\n        this.messages.push(new Message(username, content, time));\r\n        //reseting the input\r\n        this.messageContentInput = \"\";\r\n        this.allowSendingMessages = false;\r\n    }\r\n    onMessageContentInputChange(event) {\r\n        this.messageContentInput = event.target.value;\r\n        if (this.messageContentInput.trim() === \"\") {\r\n            this.allowSendingMessages = false;\r\n        }\r\n        else {\r\n            this.allowSendingMessages = true;\r\n        }\r\n    }\r\n    onInputKeyDown(event) {\r\n        if (event.key === \"Enter\" && !event.repeat) {\r\n            this.onSendMessage();\r\n        }\r\n    }\r\n    adjustScroll() {\r\n        const messagesContainer = this.messagesContainerRef.nativeElement;\r\n        if (messagesContainer.scrollTop + messagesContainer.clientHeight >= messagesContainer.scrollHeight - 250) {\r\n            messagesContainer.scrollTop = messagesContainer.scrollHeight;\r\n        }\r\n    }\r\n    scrollDown() {\r\n        this.messagesContainerRef.nativeElement.scrollTo({\r\n            top: this.messagesContainerRef.nativeElement.scrollHeight,\r\n            behavior: \"smooth\"\r\n        });\r\n    }\r\n    showScrollDownButton() {\r\n        const messagesContainer = this.messagesContainerRef.nativeElement;\r\n        return messagesContainer.scrollTop + messagesContainer.clientHeight < messagesContainer.scrollHeight - 250;\r\n    }\r\n    onReplyClick(event) {\r\n        this.messageContentInput = `@${event.username} `;\r\n    }\r\n    addAlert(type, content, time = 5000) {\r\n        const alert = this.alerts[this.alerts.push({\r\n            type: type,\r\n            content: content\r\n        })];\r\n        setTimeout(() => {\r\n            this.alerts.splice(this.alerts.indexOf(alert), 1);\r\n        }, time);\r\n    }\r\n    onAlertClose(index) {\r\n        this.alerts.splice(index, 1);\r\n    }\r\n};\r\n__decorate([\r\n    ViewChild(\"messagesContainer\", { static: true })\r\n], ChatboxComponent.prototype, \"messagesContainerRef\", void 0);\r\nChatboxComponent = __decorate([\r\n    Component({\r\n        selector: 'app-chatbox',\r\n        templateUrl: './chatbox.component.html',\r\n        styleUrls: ['./chatbox.component.css']\r\n    })\r\n], ChatboxComponent);\r\nexport { ChatboxComponent };\r\n"]},"metadata":{},"sourceType":"module"}